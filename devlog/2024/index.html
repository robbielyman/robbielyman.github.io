<!DOCTYPE html>
<html>
  <head id="head">
    <meta charset="UTF-8">
    <meta name="description" content="alanza.xyz: Robbie Lyman">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="Robbie Lyman">
    <meta name="twitter:author" content="Robbie Lyman">
    <meta name="twitter:description" content="alanza.xyz: Robbie Lyman">
    <meta name="twitter:title" content="Devlog | alanza.xyz">
    <meta name="twitter:image" content="https://alanza.xyz/headshot.jpeg">
    <meta property="og:type" content="website">
    <meta property="og:title" conten="Devlog | alanza.xyz">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title id="title">
      Devlog
      - alanza.xyz
    </title>
    <link rel="stylesheet" type="text/css" href="/fonts.css">
    <link rel="stylesheet" type="text/css" href="/style.css">
    <link rel="stylesheet" type="text/css" href="/highlight.css">
    <link href="https://merveilles.town/@alanza" rel="me">
    
    
  </head>
  <body>
    <nav id="menu" class="centered">
      <a href="/">Home</a>
      •
      <a href="/math/">Math</a>
      •
      <a href="https://github.com/robbielyman">Code</a>
      •
      <a href="/log/">Blog</a>
      •
      <a href="/devlog/">Devlog</a>
    </nav>
    <div id="content">
      
<h3 class="overtitle centered">Devlog – alanza.xyz</h3>
  <h1 class="centered title">ROBBIE LYMAN</h1>
  <h3 class="centered subtitle">Devlog</h3>
  <div id="page"><div id=2024-10-08><h1><a class="" href="#2024-10-08">241008 – busted</a></h1><p><a href="https://github.com/robbielyman/seamstress">Seamstress</a> version 2 (or rather, the branch where I’m currently working) now once again is capable of running unit tests on the functionality of seamstress when run as <code>seamstress test</code>. Currently the suite of tests is entirely vendored, but it seems likely that I will eventually want to extend this capability to run tests in the directory seamstress is launched from as well.</p><p>Unit tests are powered by <a href="https://github.com/lunarmodules/busted">luarocks busted</a>. My initial go at incorporating busted used its provided <code>runner</code> script, but I found this difficult to grok and the default behavior didn’t suit my use cases. Therefore part of the project this go-around was to properly understand what is needed to set up a busted runner.</p><p>It turns out to be not so bad! This seems to be the bones of it:</p><p><figure><pre><code class="lua"><span class="keyword">local</span> <span class="keyword function">function</span> <span class="function">runner</span><span class="punctuation bracket">(</span><span class="punctuation bracket">)</span>
  <span class="keyword">local</span> <span class="variable">busted</span> <span class="operator">=</span> <span class="function call">require</span> <span class="string">&apos;busted.core&apos;</span> <span class="punctuation bracket">(</span><span class="punctuation bracket">)</span>
  <span class="function call">require</span> <span class="string">&apos;busted&apos;</span> <span class="punctuation bracket">(</span><span class="variable">busted</span><span class="punctuation bracket">)</span>
  <span class="keyword">local</span> <span class="variable">directory</span> <span class="operator">=</span> <span class="variable">os</span><span class="punctuation delimiter">.</span><span class="function call">getenv</span><span class="punctuation bracket">(</span><span class="string">&quot;SEAMSTRESS_LUA_PATH&quot;</span><span class="punctuation bracket">)</span> <span class="operator">..</span>
      <span class="variable">package</span><span class="punctuation delimiter">.</span><span class="field">config</span><span class="punctuation delimiter">:</span><span class="method call">sub</span><span class="punctuation bracket">(</span><span class="number">1</span><span class="punctuation delimiter">,</span> <span class="number">1</span><span class="punctuation bracket">)</span> <span class="operator">..</span> <span class="string">&quot;test&quot;</span>
  <span class="keyword">local</span> <span class="variable">loadTestFiles</span> <span class="operator">=</span>
    <span class="function call">require</span> <span class="string">&apos;busted.modules.test_file_loader&apos;</span><span class="punctuation bracket">(</span><span class="variable">busted</span><span class="punctuation delimiter">,</span> <span class="constructor">{</span> <span class="string">&apos;lua&apos;</span> <span class="constructor">}</span><span class="punctuation bracket">)</span>
  <span class="function call">loadTestFiles</span><span class="punctuation bracket">(</span><span class="constructor">{</span> <span class="variable">directory</span> <span class="constructor">}</span><span class="punctuation delimiter">,</span> <span class="constructor">{</span> <span class="string">&apos;_spec&apos;</span> <span class="constructor">}</span><span class="punctuation delimiter">,</span> <span class="constructor">{</span> <span class="field">excludes</span> <span class="operator">=</span> <span class="constructor">{</span><span class="constructor">}</span> <span class="constructor">}</span><span class="punctuation bracket">)</span>
  
  <span class="keyword">local</span> <span class="variable">handler</span> <span class="operator">=</span> <span class="function call">require</span> <span class="string">&apos;busted.outputHandlers.base&apos;</span> <span class="punctuation bracket">(</span><span class="punctuation bracket">)</span>
  <span class="variable">handler</span><span class="punctuation delimiter">:</span><span class="method call">subscribe</span><span class="punctuation bracket">(</span><span class="constructor">{</span> <span class="field">language</span> <span class="operator">=</span> <span class="string">&apos;en&apos;</span> <span class="constructor">}</span><span class="punctuation bracket">)</span>

  <span class="keyword">local</span> <span class="variable">execute</span> <span class="operator">=</span> <span class="function call">require</span> <span class="string">&apos;busted.execute&apos;</span> <span class="punctuation bracket">(</span><span class="variable">busted</span><span class="punctuation bracket">)</span>
  <span class="function call">execute</span><span class="punctuation bracket">(</span><span class="number">1</span><span class="punctuation delimiter">,</span> <span class="constructor">{</span><span class="constructor">}</span><span class="punctuation bracket">)</span>
<span class="keyword function">end</span>
</code></pre>
<figcaption>An excerpt of the first draft of seamstress 2’s busted runner</figcaption></figure></p><p>(Apologies for the slightly haphazard syntax highlighting style; I’ll work on it soon.)</p><p>Anyway, this snippet of code is pretty interesting: <code>busted</code> apparently wants to be loaded twice, once as <code>require &apos;busted.core&apos;</code> which, as appears to be common practice among many luarocks libraries, returns a function rather than a table, and then again as <code>require &apos;busted&apos;</code>. We’re using busted’s builtin test file loader which hooks Lua files in the specified directory with filename containing <code>_spec</code> up to busted’s complicated environment hijacking scheme. We’re also using (actually extending) busted’s base output handler, which is in charge of keeping track of the number of succeeded and failed tests.</p><p>In seamstress 2, this runner function is called as <code>seamstress.async(runner)()</code>, which is crucial for testing seamstress itself: by running the tests in an asynchronous context (which is to say, on the event loop rather than immediately) we gain the ability to yield execution from the test back to the seamstress environment, allowing us to test functions which depend on input from outside of seamstress, or are fundamentally time-based, for example.</p></div><div id=2024-10-05><h1><a class="" href="#2024-10-05">241005</a></h1><p>Still figuring out the right cadence for posting here. I think the answer is that I should post when I do work, rather than attempting to post, for example, every weekday.</p><p><a href="https://just-be.dev">Justin Bennett</a> has been organizing a “Side Project Saturday” event most weekends here in Brooklyn; I’ve managed to attend two so far, the second of which was today.</p><p>I worked on <a href="https://github.com/robbielyman/seamstress">seamstress</a> version 2. Today I mostly revisited <code>seamstress.async</code> and <code>seamstress.async.Promise</code>, which are implementations of JavaScript style Promises and asynchronous functions in Lua for use with libxev. So far, the implementation is basically complete (although I’m unsure what the expectation is when you execute <code>Promise.race()</code> with an empty list of Promises in JavaScript: should it resolve or reject?) but I still need to add documentation for use with LuaLS, as well as <code>README</code> documentation and eventually actual documentation, which will live on this website but currently has no home. (So much documenting!!)</p><p>We ended the day with presentations, all of which were so so cool. Maybe my favorite was this: Owen, another attendee, shared a bit about some material design he’s been working on, thinking through placement of heatsinks, the mechanical operations behind latching drawers, distributing heat evenly throughout a machine, etc. Really an immediate clue-in about what is so cool about like 10 different things I hadn’t previously given a second glance to.</p><p>The immediate next step with seamstress is to hook up <code>busted</code>-powered testing. I started working on this (I think to feel like I did it properly, I need to write my own version of the <code>busted</code> test runner), but found myself browsing the internet instead. Since I came back from Side Project Saturday intending to do more than just this with my day, I think this <em>is</em> actually the signal that I was waiting for that I had hit a natural inflection point in the process. It was interesting to consider that I hadn’t noticed it initially because I was expecting a conscious “ah, we’ve hit a stopping point” instead.</p></div><div id=2024-10-04><h1><a class="" href="#2024-10-04">241004</a></h1><p>I clearly did not post any blog posts yesterday. Always nice to check in with collaborators when stuck; I think the lemma I’ve been obsessing over is just not quite true, which is super interesting to discover.</p></div><div id=2024-10-03><h1><a class="" href="#2024-10-03">241003 – What day is it today?</a></h1><p>I think I’m gonna finish out my day by writing a new blog post instead of getting trapped in porting old ones.</p><p>Spent a lot of the day going through a draft of a joint paper. Found a way closer into arguing a certain lemma that I will be the first to admit I am overly fixated on proving.</p><p>I suppose soon I’m going to have to think about how to split up my really long paper into more digestible chunks to publish. The struggle is that the paper is still pretty close to having one theme. Well, I suppose that’s one struggle. The other struggle is that the paper is a hammer in search of nails. I really liked using the paper as an opportunity to learn about tool-building, but the theorem is much more usually the organizational principle of a math paper.</p></div><div id=2024-10-02><h1><a class="" href="#2024-10-02">241002 – Trees</a></h1><p>Made use of some high-powered observations in class today. Probably this deserves an actual math blog post, huh, since I kind of don’t want to write LaTeX in this space, but: first the moduli space idea—given a collection of disparate interesting things, can you assemble them into <em>one</em> thing that parametrizes the originals and gives the whole some new structure which might be interesting to investigate. And then secondly, a cute trick: if you have uniformity but also the ability to rescale things, that uniform thing suddenly becomes nothing… Okay, yeah, I’ll go write a blog post, fine.</p><p>Fun, also, after the chaos of the past several years, to have more continuity lately to the point where I can start to see patterns. Fall is a time to focus in.</p></div><div id=2024-10-01><h1><a class="" href="#2024-10-01">241001 – Art</a></h1><p>Interesting observation: in (good) digital art, almost everything has a thickness. Even stuff that scans as linework is very rarely actually lines; so using the “stroke” option in Illustrator (which I spent most of the day in) is usually not the move.</p><p>I’m working on a postcard for <a href="/the-play-about-the-blow-job/">the play I’m composing music for</a>, hence the work in Illustrator.</p></div><div id=2024-09-30><h1><a class="" href="#2024-09-30">240930 – Hello World</a></h1><p>Going to start keep little microblogs of work I do here. Today I added this section to my website, prompted by <a href="https://kristoff.it/blog/critical-social-infrastructure/">this blog post by Loris Cro</a>.</p><p>I have two laptops, one of which lives in my office at Rutgers and which used to run Asahi Linux. This morning it occurred to me that my use of Linux was holding me back. For example, while I believe I’ve managed to get Bluetooth audio and the webcam working independently, I hadn’t managed to add that together to end up with a functional Zoom experience. I need to use Zoom every week for research meetings, which meant, functionally, that I had to carry my other laptop to work every day, completely defeating the purpose of having a second one.</p><p>Today in class, we continued working through a book chapter by Mladen Bestvina about real trees. This brought us to a very heady idea: given an action of a group on a metric space by isometries, and a basepoint in that metric space which is not a global fixed point, pulling back yields a pseudometric on the group. Focusing on the pseudometric and projectivizing yields a kind of moduli space for group actions on metric spaces: indeed, if you assert that the action is continuous, you can equip this space with the (quotient of the) compact–open topology, and talk about convergence of (basepointed) group actions!</p><p>Aside from this, I worked more on my actual blog, mostly writing a first new post for it; porting old posts will be a slower process.</p></div></div>

    </div>
    <div id="footer-links">
      <img src="/rc_logo.png" style="height:1em;
      width:auto;">
      Want to become a better programmer?
      <a href="https://www.recurse.com/scout/click?t=481004d6b700a153d74901f056b2c9f0">
        Join the Recurse Center!
      </a>
    </div>
  </body>
</html>
